# 依赖与环境

<cite>
**本文档中引用的文件**  
- [PdfHelperLibrary.csproj](file://PdfHelperLibrary/PdfHelperLibrary.csproj)
- [PdfHelperLibraryX.csproj](file://PdfHelperLibraryX/PdfHelperLibraryX.csproj)
- [packages.config](file://PdfHelperLibrary/packages.config)
- [ImagerHelper.cs](file://PdfHelperLibrary/ImagerHelper.cs)
- [PdfTool.csproj](file://PdfTool/PdfTool.csproj)
- [ExcelTool.csproj](file://ExcelTool/ExcelTool.csproj)
- [PdfHelperLibrary3.csproj](file://PdfHelperLibrary3/PdfHelperLibrary3.csproj)
- [README.md](file://README.md)
</cite>

## 目录
1. [核心外部依赖项](#核心外部依赖项)
2. [NuGet包管理](#nuget包管理)
3. [开发环境搭建](#开发环境搭建)
4. [项目结构说明](#项目结构说明)

## 核心外部依赖项

本项目使用了多个核心PDF处理库，这些库在不同的项目中被引用，以实现PDF文件的各种操作功能。

### PDFsharp
- **版本**: 1.50.5147 (用于 .NET Framework 项目), 6.2.2 (用于 .NET 8.0 项目)
- **用途**: 用于PDF文档的创建、修改、合并、拆分等操作。该库提供了丰富的API来处理PDF文档的页面、字体、图形和文本。
- **官方文档**: [https://github.com/empira/PDFsharp](https://github.com/empira/PDFsharp)

### Tabula
- **版本**: 0.1.3
- **用途**: 专门用于从PDF文件中提取表格数据。该库能够识别PDF中的表格结构并将其转换为结构化数据格式。
- **官方文档**: [https://github.com/tabulapdf/tabula](https://github.com/tabulapdf/tabula)

### PdfPig
- **版本**: 0.1.8
- **用途**: 用于读取和解析PDF文件内容，包括文本提取、页面分析和文档结构解析。该库提供了对PDF内部结构的低级别访问。
- **官方文档**: [https://github.com/UglyToad/PdfPig](https://github.com/UglyToad/PdfPig)

### O2S.Components.PDFRender4NET
- **版本**: 4.7.3.0
- **用途**: 用于将PDF文档渲染为图像格式。该库在`ImagerHelper.cs`中被引用，用于实现PDF到图像的转换功能。
- **官方文档**: [https://www.o2sol.com/pdf-renderer/overview/](https://www.o2sol.com/pdf-renderer/overview/)

**Section sources**
- [PdfHelperLibrary.csproj](file://PdfHelperLibrary/PdfHelperLibrary.csproj#L39-L48)
- [PdfHelperLibraryX.csproj](file://PdfHelperLibraryX/PdfHelperLibraryX.csproj#L12)
- [packages.config](file://PdfHelperLibrary/packages.config#L4-L5)
- [ImagerHelper.cs](file://PdfHelperLibrary/ImagerHelper.cs#L1)
- [PdfHelperLibrary3.csproj](file://PdfHelperLibrary3/PdfHelperLibrary3.csproj#L26-L28)

## NuGet包管理

本项目使用NuGet包管理器来管理外部依赖项。项目中存在两种不同的包管理方式：传统的`packages.config`文件和现代的`PackageReference`格式。

### 安装依赖项
1. 打开Visual Studio并加载解决方案
2. 右键点击解决方案，选择"还原NuGet包"
3. Visual Studio将自动从`packages.config`或`.csproj`文件中读取依赖项列表，并从NuGet服务器下载所需的包

### 更新依赖项
1. 在Visual Studio中，右键点击项目并选择"管理NuGet包"
2. 切换到"更新"选项卡
3. 选择需要更新的包并点击"更新"按钮
4. 或者使用Package Manager Console执行命令：
   ```
   Update-Package -ProjectName [项目名称]
   ```

### 包管理配置
项目中使用了两种包管理格式：
- 对于.NET Framework项目，使用`packages.config`文件来列出所有依赖项
- 对于较新的.NET项目，使用`PackageReference`元素直接在`.csproj`文件中声明依赖项

**Section sources**
- [PdfHelperLibrary.csproj](file://PdfHelperLibrary/PdfHelperLibrary.csproj#L36-L76)
- [PdfHelperLibraryX.csproj](file://PdfHelperLibraryX/PdfHelperLibraryX.csproj#L12-L14)
- [packages.config](file://PdfHelperLibrary/packages.config#L1-L12)

## 开发环境搭建

### .NET Framework版本要求
本项目主要基于.NET Framework 4.7.2构建。所有传统的Windows Forms应用程序和类库都针对此版本。

- **主要项目**: PdfTool, PdfHelperLibrary, ExcelTool, FileTool等
- **目标框架**: v4.7.2
- **验证方法**: 在`.csproj`文件中查看`<TargetFrameworkVersion>`元素

### .NET 8.0项目
部分新项目已迁移到.NET 8.0，使用了现代的SDK风格项目文件。

- **项目示例**: PdfHelperLibraryX
- **目标框架**: net8.0
- **项目文件格式**: 使用`<Project Sdk="Microsoft.NET.Sdk">`的现代格式

### 必需的系统组件
1. **Visual Studio 2022** 或更高版本
   - 需要安装.NET Desktop Development工作负载
   - 推荐版本：Visual Studio 2022 17.8+

2. **.NET Framework 4.7.2开发工具包**
   - 可从Microsoft官方网站下载
   - 包含编译和运行项目所需的库和工具

3. **.NET 8.0 SDK**
   - 用于构建和运行.NET 8.0项目
   - 可从[https://dotnet.microsoft.com/download](https://dotnet.microsoft.com/download)获取

4. **NuGet包管理器**
   - Visual Studio内置，无需单独安装
   - 确保能够访问nuget.org公共源

### 环境搭建步骤
1. 安装Visual Studio 2022并选择".NET桌面开发"工作负载
2. 安装.NET 8.0 SDK
3. 克隆项目仓库到本地
4. 打开`PdfTool.sln`解决方案文件
5. 等待Visual Studio自动还原NuGet包，或手动右键点击解决方案选择"还原NuGet包"
6. 构建解决方案以验证环境配置正确

**Section sources**
- [PdfTool.csproj](file://PdfTool/PdfTool.csproj#L12)
- [PdfHelperLibrary.csproj](file://PdfHelperLibrary/PdfHelperLibrary.csproj#L12)
- [PdfHelperLibraryX.csproj](file://PdfHelperLibraryX/PdfHelperLibraryX.csproj#L4)
- [ExcelTool.csproj](file://ExcelTool/ExcelTool.csproj#L12)

## 项目结构说明

项目包含多个子项目，每个项目都有特定的功能：

- **PdfHelperLibrary**: 核心PDF处理库，包含各种PDF操作的辅助方法
- **PdfTool**: 主要的Windows Forms应用程序，提供图形化界面进行PDF操作
- **PdfHelperLibraryX**: 基于.NET 8.0的新版PDF处理库
- **ExcelTool**: Excel文件处理工具
- **FileTool**: 通用文件操作工具
- **PdfConsoleApp**: PDF处理的控制台应用程序示例

这种模块化设计使得核心功能可以在不同类型的客户端应用程序中重用。

**Section sources**
- [README.md](file://README.md)
- [PdfTool.csproj](file://PdfTool/PdfTool.csproj)
- [PdfHelperLibrary.csproj](file://PdfHelperLibrary/PdfHelperLibrary.csproj)